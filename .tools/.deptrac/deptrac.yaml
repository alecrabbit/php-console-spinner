deptrac:
  paths:
    - ../../src
    - ../../vendor
  exclude_files:
    - '#.*test.*#'

#  layers:
#    - name: ModuleCore
#      collectors:
#        - type: bool
#          must:
#            - type: directory
#              regex: '%CoreDirectory%'
#
#  ruleset:
#    ModuleExtras:
#      - ModuleCore
#    ModuleCore:

  layers:
    -
      name: VendorSymfony
      collectors:
        - type: bool
          must:
            - type: className
              value: .*Symfony\\.*
          must_not:
            - type: className
              value: .*Symfony\\.*\\Test\\.*
    -
      name: VendorRevolt
      collectors:
        - type: bool
          must:
            - type: className
              value: .*Revolt\\EventLoop\\.*
    -
      name: VendorReact
      collectors:
        - type: bool
          must:
            - type: className
              value: .*React\\EventLoop\\.*
#          must_not:
#            - type: className
#              value: .*Symfony\\.*\\Test\\.*
    -
      name: ModuleMixin
      collectors:
        -
          type: className
          value: .*AlecRabbit\\Spinner\\Mixin\\.*
    -
      name: ModuleException
      collectors:
        -
          type: className
          value: .*AlecRabbit\\Spinner\\Exception\\.*
    -
      name: ModuleHelper
      collectors:
        -
          type: className
          value: AlecRabbit\\Spinner\\Helper\\.*
    -
      name: ModuleCore
      collectors:
        -
          type: className
          value: AlecRabbit\\Spinner\\Core\\.*
    -
      name: ModuleExtras
      collectors:
        -
          type: className
          value: .*AlecRabbit\\Spinner\\Extras\\.*
    -
      name: ModuleAsynchronous
      collectors:
        -
          type: className
          value: AlecRabbit\\Spinner\\Asynchronous\\.*
  ruleset:
    ModuleAsynchronous:
      - +ModuleCore
      - +ModuleException
      - +ModuleHelper
      - +VendorRevolt
      - +VendorReact
    ModuleExtras:
      - +ModuleCore
      - +ModuleException
      - +VendorSymfony
    ModuleHelper:
      - +ModuleException
      - +ModuleMixin
    ModuleCore:
      - +ModuleException
      - +ModuleHelper
      - +ModuleMixin
    ModuleException: ~
    ModuleMixin: ~
    VendorSymfony: ~
  skip_violations:
    VendorReact: ~
